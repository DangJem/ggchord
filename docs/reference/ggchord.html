<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ggchord: A ggplot2-based tool for multi-sequence alignment chord plots — ggchord • ggchord</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="ggchord: A ggplot2-based tool for multi-sequence alignment chord plots — ggchord"><meta property="og:description" content="This function is used to draw chord plots containing multiple sequences, which can display alignment relationships between sequences and gene annotation information.
It supports customizing various parameters such as sequence arrangement, colors, ribbon styles, and gene arrow styles, making it suitable for genome alignment visualization."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggchord</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ggchord_vignette.html">Tutorial</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DangJem/ggchord/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ggchord: A ggplot2-based tool for multi-sequence alignment chord plots</h1>
    <small class="dont-index">Source: <a href="https://github.com/DangJem/ggchord/blob/HEAD/R/ggchord.R" class="external-link"><code>R/ggchord.R</code></a></small>
    <div class="hidden name"><code>ggchord.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is used to draw chord plots containing multiple sequences, which can display alignment relationships between sequences and gene annotation information.
It supports customizing various parameters such as sequence arrangement, colors, ribbon styles, and gene arrow styles, making it suitable for genome alignment visualization.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ggchord</span><span class="op">(</span></span>
<span>  <span class="va">seq_data</span>,</span>
<span>  ribbon_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gene_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seq_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seq_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seq_orientation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seq_gap <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  seq_radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seq_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seq_curvature <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gene_offset <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  gene_width <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  gene_label_show <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gene_label_rotation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  gene_label_size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  gene_label_radial_offset <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  gene_label_circum_offset <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  gene_label_circum_limit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gene_color_scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"strand"</span>, <span class="st">"manual"</span><span class="op">)</span>,</span>
<span>  gene_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gene_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ribbon_color_scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pident"</span>, <span class="st">"query"</span>, <span class="st">"single"</span><span class="op">)</span>,</span>
<span>  ribbon_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ribbon_alpha <span class="op">=</span> <span class="fl">0.35</span>,</span>
<span>  ribbon_ctrl_point <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  ribbon_gap <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  axis_gap <span class="op">=</span> <span class="fl">0.04</span>,</span>
<span>  axis_tick_major_number <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  axis_tick_major_length <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  axis_tick_minor_number <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  axis_tick_minor_length <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  axis_label_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  axis_label_offset <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  axis_label_orientation <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>  rotation <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  panel_margin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_axis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-seq-data">seq_data<a class="anchor" aria-label="anchor" href="#arg-seq-data"></a></dt>
<dd><p>data.frame/tibble, required. A data frame containing basic sequence information, must include columns:
- seq_id: Unique sequence identifier (character)
- length: Sequence length (numeric, &gt; 0)</p></dd>


<dt id="arg-ribbon-data">ribbon_data<a class="anchor" aria-label="anchor" href="#arg-ribbon-data"></a></dt>
<dd><p>data.frame/tibble, optional. BLAST alignment result data frame, must include columns:
- qaccver: Query sequence ID (matching seq_id)
- saccver: Subject sequence ID (matching seq_id)
- length: Alignment length
- pident: Percentage of sequence identity (0-100)
- qstart/qend: Start/end positions of the query sequence in the alignment
- sstart/send: Start/end positions of the subject sequence in the alignment</p></dd>


<dt id="arg-gene-data">gene_data<a class="anchor" aria-label="anchor" href="#arg-gene-data"></a></dt>
<dd><p>data.frame/tibble, optional. Gene annotation data frame, must include columns:
- seq_id: ID of the associated sequence (matching seq_id)
- start/end: Gene start/end positions (numeric)
- strand: Strand direction (only "+" or "-")
- anno: Gene annotation name (character)</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Character. Main title of the plot, default NULL (no title displayed)</p></dd>


<dt id="arg-seq-order">seq_order<a class="anchor" aria-label="anchor" href="#arg-seq-order"></a></dt>
<dd><p>Character vector, optional. Specifies the drawing order of sequences (must be a subset of seq_id), default follows the order in seq_data</p></dd>


<dt id="arg-seq-labels">seq_labels<a class="anchor" aria-label="anchor" href="#arg-seq-labels"></a></dt>
<dd><p>Character vector/named vector, optional. Sequence labels (length matching the number of sequences or named to match seq_id), default uses seq_id</p></dd>


<dt id="arg-seq-orientation">seq_orientation<a class="anchor" aria-label="anchor" href="#arg-seq-orientation"></a></dt>
<dd><p>Numeric (1 or -1), optional. Sequence direction (1 = forward, -1 = reverse), supports single value/vector/named vector, default 1</p></dd>


<dt id="arg-seq-gap">seq_gap<a class="anchor" aria-label="anchor" href="#arg-seq-gap"></a></dt>
<dd><p>Numeric (0 &lt;= x &lt; 0.5), optional. Proportion of gap between sequences, supports single value/vector/named vector, default 0.03</p></dd>


<dt id="arg-seq-radius">seq_radius<a class="anchor" aria-label="anchor" href="#arg-seq-radius"></a></dt>
<dd><p>Numeric (&gt; 0), optional. Radius of sequence arcs, supports single value/vector/named vector, default 1.0</p></dd>


<dt id="arg-seq-colors">seq_colors<a class="anchor" aria-label="anchor" href="#arg-seq-colors"></a></dt>
<dd><p>Color vector/named vector, optional. Colors of sequence arcs, default auto-generated based on RColorBrewer Set1</p></dd>


<dt id="arg-seq-curvature">seq_curvature<a class="anchor" aria-label="anchor" href="#arg-seq-curvature"></a></dt>
<dd><p>Numeric, optional. Curvature of sequence arcs (0 = straight line, 1 = standard arc, &gt; 1 = more curved), default 1.0</p></dd>


<dt id="arg-gene-offset">gene_offset<a class="anchor" aria-label="anchor" href="#arg-gene-offset"></a></dt>
<dd><p>Numeric/vector/list, optional. Radial offset of gene arrows from sequences (positive values outward, negative values inward), supports:
- single value: shared by all sequences/strands
- vector: length matching the number of sequences (assigned by sequence)
- list: named list (elements are single values or vectors with "+"/"-" to distinguish strands), default 0.1</p></dd>


<dt id="arg-gene-width">gene_width<a class="anchor" aria-label="anchor" href="#arg-gene-width"></a></dt>
<dd><p>Numeric/vector/list, optional. Width of gene arrows, format same as gene_offset, default 0.05</p></dd>


<dt id="arg-gene-label-show">gene_label_show<a class="anchor" aria-label="anchor" href="#arg-gene-label-show"></a></dt>
<dd><p>Logical. Whether to display gene labels, default FALSE</p></dd>


<dt id="arg-gene-label-rotation">gene_label_rotation<a class="anchor" aria-label="anchor" href="#arg-gene-label-rotation"></a></dt>
<dd><p>Numeric/vector/list, optional. Rotation angle (degrees) of gene labels, format same as gene_offset, default 0</p></dd>


<dt id="arg-gene-label-size">gene_label_size<a class="anchor" aria-label="anchor" href="#arg-gene-label-size"></a></dt>
<dd><p>Numeric. Font size of gene labels, default 2.5</p></dd>


<dt id="arg-gene-label-radial-offset">gene_label_radial_offset<a class="anchor" aria-label="anchor" href="#arg-gene-label-radial-offset"></a></dt>
<dd><p>Numeric/vector/list, optional. Radial offset of gene labels relative to arrows, format same as gene_offset, default 0</p></dd>


<dt id="arg-gene-label-circum-offset">gene_label_circum_offset<a class="anchor" aria-label="anchor" href="#arg-gene-label-circum-offset"></a></dt>
<dd><p>Numeric/vector/list, optional. Circumferential offset proportion of gene labels along sequences, format same as gene_offset, default 0</p></dd>


<dt id="arg-gene-label-circum-limit">gene_label_circum_limit<a class="anchor" aria-label="anchor" href="#arg-gene-label-circum-limit"></a></dt>
<dd><p>Logical/vector/list, optional. Whether to limit circumferential offset to half the gene length, format same as gene_offset, default TRUE</p></dd>


<dt id="arg-gene-color-scheme">gene_color_scheme<a class="anchor" aria-label="anchor" href="#arg-gene-color-scheme"></a></dt>
<dd><p>Character. Color scheme for genes, optional "strand" (by strand direction) or "manual" (by annotation), default "strand"</p></dd>


<dt id="arg-gene-colors">gene_colors<a class="anchor" aria-label="anchor" href="#arg-gene-colors"></a></dt>
<dd><p>Color vector, optional. Fill colors for gene arrows, format depends on gene_color_scheme:
- "strand": named vector ("+"/"-"), unnamed vector of length 1/2
- "manual": named vector (matching anno), unnamed vector (recycled), default auto-generated</p></dd>


<dt id="arg-gene-order">gene_order<a class="anchor" aria-label="anchor" href="#arg-gene-order"></a></dt>
<dd><p>Character vector, optional. Display order of genes in the legend (matching anno), default follows the order in data</p></dd>


<dt id="arg-ribbon-color-scheme">ribbon_color_scheme<a class="anchor" aria-label="anchor" href="#arg-ribbon-color-scheme"></a></dt>
<dd><p>Character. Color scheme for ribbons, optional "pident" (gradient by identity), "query" (by query sequence), "single" (uniform color), default "pident"</p></dd>


<dt id="arg-ribbon-colors">ribbon_colors<a class="anchor" aria-label="anchor" href="#arg-ribbon-colors"></a></dt>
<dd><p>Color vector, optional. Color parameters for ribbons:
- "single": uniform color
- "query": color vector matching seq_id
- "pident": color gradient (at least 2 colors), default blue-to-yellow gradient</p></dd>


<dt id="arg-ribbon-alpha">ribbon_alpha<a class="anchor" aria-label="anchor" href="#arg-ribbon-alpha"></a></dt>
<dd><p>Numeric (0-1). Transparency of ribbons, default 0.35</p></dd>


<dt id="arg-ribbon-ctrl-point">ribbon_ctrl_point<a class="anchor" aria-label="anchor" href="#arg-ribbon-ctrl-point"></a></dt>
<dd><p>Vector/list, optional. Control points for Bézier curves (adjust ribbon shape):
- vector: length 2 (single control point) or 4 (c1x,c1y,c2x,c2y for two control points)
- list: each element is a sublist with 1-2 control points, default c(0,0)</p></dd>


<dt id="arg-ribbon-gap">ribbon_gap<a class="anchor" aria-label="anchor" href="#arg-ribbon-gap"></a></dt>
<dd><p>Numeric/vector/named vector, optional. Radial distance between sequences and ribbons, default 0.15</p></dd>


<dt id="arg-axis-gap">axis_gap<a class="anchor" aria-label="anchor" href="#arg-axis-gap"></a></dt>
<dd><p>Numeric/vector/named vector, optional. Radial distance between sequences and axes, default 0.04</p></dd>


<dt id="arg-axis-tick-major-number">axis_tick_major_number<a class="anchor" aria-label="anchor" href="#arg-axis-tick-major-number"></a></dt>
<dd><p>Integer/vector/named vector, optional. Number of major ticks, default 5</p></dd>


<dt id="arg-axis-tick-major-length">axis_tick_major_length<a class="anchor" aria-label="anchor" href="#arg-axis-tick-major-length"></a></dt>
<dd><p>Numeric/vector/named vector, optional. Length proportion of major ticks, default 0.02</p></dd>


<dt id="arg-axis-tick-minor-number">axis_tick_minor_number<a class="anchor" aria-label="anchor" href="#arg-axis-tick-minor-number"></a></dt>
<dd><p>Integer/vector/named vector, optional. Number of minor ticks per major tick, default 4</p></dd>


<dt id="arg-axis-tick-minor-length">axis_tick_minor_length<a class="anchor" aria-label="anchor" href="#arg-axis-tick-minor-length"></a></dt>
<dd><p>Numeric/vector/named vector, optional. Length proportion of minor ticks, default 0.01</p></dd>


<dt id="arg-axis-label-size">axis_label_size<a class="anchor" aria-label="anchor" href="#arg-axis-label-size"></a></dt>
<dd><p>Numeric/vector/named vector, optional. Font size of axis labels, default 3</p></dd>


<dt id="arg-axis-label-offset">axis_label_offset<a class="anchor" aria-label="anchor" href="#arg-axis-label-offset"></a></dt>
<dd><p>Numeric/vector/named vector, optional. Offset proportion of labels relative to ticks, default 1.5</p></dd>


<dt id="arg-axis-label-orientation">axis_label_orientation<a class="anchor" aria-label="anchor" href="#arg-axis-label-orientation"></a></dt>
<dd><p>Character/numeric/vector, optional. Orientation of axis labels:
- "horizontal": horizontal
- numeric: rotation angle (degrees)
- vector: length matching the number of sequences or named vector (matching seq_id), default "horizontal"</p></dd>


<dt id="arg-rotation">rotation<a class="anchor" aria-label="anchor" href="#arg-rotation"></a></dt>
<dd><p>Numeric. Overall rotation angle of the plot (degrees), default 45</p></dd>


<dt id="arg-panel-margin">panel_margin<a class="anchor" aria-label="anchor" href="#arg-panel-margin"></a></dt>
<dd><p>Numeric/list, optional. Margin around the plot panel (t=top, r=right, b=bottom, l=left):
- single value: same margin for all sides
- list: named list (e.g., list(t=1,r=1)), default 0</p></dd>


<dt id="arg-show-legend">show_legend<a class="anchor" aria-label="anchor" href="#arg-show-legend"></a></dt>
<dd><p>Logical. Whether to display legends, default TRUE</p></dd>


<dt id="arg-show-axis">show_axis<a class="anchor" aria-label="anchor" href="#arg-show-axis"></a></dt>
<dd><p>Logical. Whether to display axes and ticks, default TRUE</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>Logical. Whether to output debugging information (e.g., number of valid ribbons), default FALSE</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A ggplot2 graph object, which can be further adjusted with ggplot2 functions</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example code</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggchord</span><span class="op">(</span></span></span>
<span class="r-in"><span>  seq_data <span class="op">=</span> <span class="va">seq_data_example</span>,</span></span>
<span class="r-in"><span>  ribbon_data <span class="op">=</span> <span class="va">ribbon_data_example</span>,</span></span>
<span class="r-in"><span>  gene_data <span class="op">=</span> <span class="va">gene_data_example</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jem Dang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

